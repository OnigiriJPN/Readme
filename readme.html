<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AutoEditor-APS ã®ä½¿ã„æ–¹</title>
    <style>
      body {
        font-family: "Segoe UI", sans-serif;
        padding: 20px;
        background: #f9f9f9;
        color: #333;
      }

      h1 {
        color: #0066cc;
      }

      ul {
        line-height: 1.6;
      }

      #comment-section {
        max-width: 600px;
        margin: 20px auto;
        font-family: Arial, sans-serif;
      }

      .comment,
      .reply {
        border: 1px solid #ddd;
        padding: 10px;
        margin-bottom: 10px;
        border-radius: 6px;
        background: #fff;
      }

      .comment-header {
        display: flex;
        align-items: center;
        margin-bottom: 6px;
      }

      .user-icon {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        margin-right: 8px;
      }

      .comment-date {
        margin-left: auto;
        font-size: 0.8em;
        color: #666;
      }

      .comment-actions button {
        margin-right: 10px;
        cursor: pointer;
        background: none;
        border: none;
        color: #007bff;
      }

      .comment-actions button:hover {
        text-decoration: underline;
      }

      .nested-replies {
        margin-left: 40px;
        margin-top: 10px;
        border-left: 2px solid #eee;
        padding-left: 10px;
      }

      .comment-image {
        max-width: 100%;
        margin-top: 8px;
        border-radius: 4px;
        box-shadow: 0 0 6px rgba(0, 0, 0, 0.1);
      }

      #comment-form textarea,
      #comment-form input[type="text"] {
        width: 100%;
        margin-bottom: 6px;
        padding: 8px;
        border-radius: 4px;
        border: 1px solid #ccc;
        resize: vertical;
      }

      #comment-form input[type="file"] {
        margin-bottom: 6px;
      }

      #post-comment,
      #github-login-btn {
        padding: 8px 12px;
        border: none;
        background-color: #007bff;
        color: white;
        border-radius: 4px;
        cursor: pointer;
      }

      #post-comment:hover,
      #github-login-btn:hover {
        background-color: #0056b3;
      }

      #message {
        resize: none;
        field-sizing: content;
      }

      #comment-section{
        display: none;
      }
    </style>
  </head>

  <body>
    <h1>AutoEditor-APS ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ï¼</h1>
    <p>ã”åˆ©ç”¨ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚</p>
    <p>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€å‹•ç”»ã‹ã‚‰ç„¡éŸ³éƒ¨åˆ†ã‚’è‡ªå‹•çš„ã«æ¤œå‡ºãƒ»å‰Šé™¤ã™ã‚‹CLIãƒ„ãƒ¼ãƒ«ã§ã™ã€‚</p>
    <h2>åŸºæœ¬çš„ãªä½¿ã„æ–¹</h2>
    <ul>
      <li>
        ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ <code>auto_edit_cli.exe</code> ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
      </li>
      <li>
        ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä¾‹ï¼š
        <ul>
          <li><code>--silent-threshold 0.04</code>ï¼šç„¡éŸ³åˆ¤å®šã®ã—ãã„å€¤</li>
          <li><code>--edit audio</code>ï¼šéŸ³å£°æ³¢å½¢ã‚’å…ƒã«ç·¨é›†</li>
          <li><code>--force</code>ï¼šéŸ³å£°ä»˜ãå‹•ç”»ã¨ã—ã¦å¼·åˆ¶å‡¦ç†</li>
        </ul>
      </li>
    </ul>
    <h2>é€£çµ¡å…ˆãƒ»ã‚µãƒãƒ¼ãƒˆ</h2>
    <p>ãƒã‚°å ±å‘Šã‚„è³ªå•ãªã©ã¯ã€ãƒã‚°ãƒ»è³ªå•ã‚³ãƒ¡ãƒ³ãƒˆã¾ã§ã”é€£çµ¡ãã ã•ã„ã€‚</p>

    <hr />
    <p>Â© 2025 AutoEditor-APS</p>

    <hr />
    <div style="max-width: 600px; margin: 20px auto">
      <button id="github-login-btn">GitHubã§ãƒ­ã‚°ã‚¤ãƒ³</button>
      <div id="user-info" style="margin-top: 10px"></div>
    </div>

    <button class="ToggleComment">ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¡¨ç¤ºã™ã‚‹</button>
    <div id="comment-section">
      <div id="comment-list"></div>
      <div id="comment-form">
      <input type="text" id="user-id" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼ID" />
      <textarea id="comment-text" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›"></textarea>
      <input type="file" id="comment-image" accept="image/*" />
      <button id="post-comment">ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿</button>
  </div>
</div>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
      import {
        getAuth,
        signInWithPopup,
        GithubAuthProvider,
        onAuthStateChanged,
        signOut,
      } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";

      // Firebaseæ§‹æˆ
      const firebaseConfig = {
        apiKey: "AIzaSyDxQZAdVvmxYDXFptD0Q0W9DOKDazpZe64",
        authDomain: "login-7af50.firebaseapp.com",
        projectId: "login-7af50",
        storageBucket: "login-7af50.firebasestorage.app",
        messagingSenderId: "467331542151",
        appId: "1:467331542151:web:22b61e1c5fedaeaa79dc22",
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const provider = new GithubAuthProvider();

      const loginBtn = document.getElementById("github-login-btn");
      const userInfoEl = document.getElementById("user-info");
      const userIdInput = document.getElementById("user-id");

      // ã‚³ãƒ¡ãƒ³ãƒˆUIè¦ç´ 
      const commentListEl = document.getElementById("comment-list");
      const commentTextEl = document.getElementById("comment-text");
      const commentImageEl = document.getElementById("comment-image");
      const postBtn = document.getElementById("post-comment");
      const ToggleComment = document.querySelector(".ToggleComment");

      let comments = JSON.parse(localStorage.getItem("comments")) || [];
      let currentUser = null;

      // Firebaseãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã®ç›£è¦–
      onAuthStateChanged(auth, (user) => {
        if (user) {
          currentUser = user;
          userInfoEl.textContent = `ãƒ­ã‚°ã‚¤ãƒ³ä¸­: ${
            user.displayName || user.email
          }`;
          userIdInput.value = user.displayName || user.email || "åŒ¿å";
          userIdInput.disabled = true;
          loginBtn.textContent = "ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ";
        } else {
          currentUser = null;
          userInfoEl.textContent = "æœªãƒ­ã‚°ã‚¤ãƒ³";
          userIdInput.value = "";
          userIdInput.disabled = false;
          loginBtn.textContent = "GitHubã§ãƒ­ã‚°ã‚¤ãƒ³";
        }
      });

      loginBtn.addEventListener("click", async () => {
        if (currentUser) {
          await signOut(auth);
        } else {
          try {
            await signInWithPopup(auth, provider);
          } catch (e) {
            alert("ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ: " + e.message);
          }
        }
      });

      function saveComments() {
        localStorage.setItem("comments", JSON.stringify(comments));
      }

      function renderReplies(replyArray, container) {
        replyArray.forEach((reply) => {
          const div = document.createElement("div");
          div.className = "reply comment";
          div.innerHTML = `
        <div class="comment-header">
          <img src="https://api.dicebear.com/5.x/initials/svg?seed=${
            reply.userId
          }" alt="icon" class="user-icon"/>
          <strong>${reply.userId}</strong>
          <span class="comment-date">${new Date(
            reply.date
          ).toLocaleString()}</span>
        </div>
        <div class="comment-body">${reply.text}</div>
        <div class="comment-actions">
          <button class="like-btn" data-id="${reply.id}">ğŸ‘ ${
            reply.likes || 0
          }</button>
          <button class="report-btn" data-id="${reply.id}">é€šå ±</button>
          <button class="delete-btn" data-id="${reply.id}">å‰Šé™¤</button>
        </div>
      `;
          container.appendChild(div);

          if (reply.replies && reply.replies.length > 0) {
            const nested = document.createElement("div");
            nested.className = "nested-replies";
            container.appendChild(nested);
            renderReplies(reply.replies, nested);
          }
        });
      }

      function renderComments() {
        commentListEl.innerHTML = "";
        comments.forEach((comment) => {
          const div = document.createElement("div");
          div.className = "comment";
          div.innerHTML = `
        <div class="comment-header">
          <img src="https://api.dicebear.com/5.x/initials/svg?seed=${
            comment.userId
          }" alt="icon" class="user-icon"/>
          <strong>${comment.userId}</strong>
          <span class="comment-date">${new Date(
            comment.date
          ).toLocaleString()}</span>
        </div>
        <div class="comment-body">
          ${comment.text}
          ${
            comment.image
              ? `<img src="${comment.image}" alt="comment image" class="comment-image"/>`
              : ""
          }
        </div>
        <div class="comment-actions">
          <button class="like-btn" data-id="${comment.id}">ğŸ‘ ${
            comment.likes || 0
          }</button>
          <button class="reply-btn" data-id="${comment.id}">è¿”ä¿¡</button>
          <button class="report-btn" data-id="${comment.id}">é€šå ±</button>
          <button class="delete-btn" data-id="${comment.id}">å‰Šé™¤</button>
        </div>
        <div class="reply-section" data-parent-id="${comment.id}"></div>
      `;
          commentListEl.appendChild(div);
          if (comment.replies && comment.replies.length > 0) {
            const replyContainer = document.createElement("div");
            replyContainer.className = "nested-replies";
            div.appendChild(replyContainer);
            renderReplies(comment.replies, replyContainer);
          }
        });
      }

      function clearForm() {
        commentTextEl.value = "";
        commentImageEl.value = "";
      }

      postBtn.addEventListener("click", () => {
        const id = Date.now().toString();
        const userId = userIdInput.value.trim() || "åŒ¿å";
        const text = commentTextEl.value.trim();
        if (!text) return alert("ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");

        if (commentImageEl.files.length > 0) {
          const file = commentImageEl.files[0];
          const reader = new FileReader();
          reader.onload = (e) => {
            comments.push({
              id,
              userId,
              text,
              date: Date.now(),
              likes: 0,
              image: e.target.result,
              replies: [],
            });
            saveComments();
            renderComments();
            clearForm();
          };
          reader.readAsDataURL(file);
        } else {
          comments.push({
            id,
            userId,
            text,
            date: Date.now(),
            likes: 0,
            image: null,
            replies: [],
          });
          saveComments();
          renderComments();
          clearForm();
        }
      });

      commentListEl.addEventListener("click", (e) => {
        const target = e.target;
        if (target.classList.contains("like-btn")) {
          const id = target.dataset.id;
          const c = findCommentById(id, comments);
          if (c) {
            c.likes = (c.likes || 0) + 1;
            saveComments();
            renderComments();
          }
        } else if (target.classList.contains("delete-btn")) {
          const id = target.dataset.id;
          if (confirm("æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) {
            deleteCommentById(id, comments);
            saveComments();
            renderComments();
          }
        } else if (target.classList.contains("report-btn")) {
          alert("é€šå ±ã—ã¾ã—ãŸã€‚é–‹ç™ºè€…ã«é€šçŸ¥ã•ã‚Œã¾ã™ã€‚");
        } else if (target.classList.contains("reply-btn")) {
          const id = target.dataset.id;
          const parentDiv = target.closest(".comment");
          const replySection = parentDiv.querySelector(".reply-section");
          if (!replySection.querySelector("textarea")) {
            const replyBox = document.createElement("div");
            replyBox.innerHTML = `
          <textarea placeholder="è¿”ä¿¡ã‚’å…¥åŠ›"></textarea>
          <button>è¿”ä¿¡é€ä¿¡</button>
          <button>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        `;
            replySection.appendChild(replyBox);

            const textarea = replyBox.querySelector("textarea");
            const sendBtn = replyBox.querySelector("button:first-of-type");
            const cancelBtn = replyBox.querySelector("button:last-of-type");

            sendBtn.addEventListener("click", () => {
              const replyText = textarea.value.trim();
              if (!replyText) return alert("è¿”ä¿¡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
              const reply = {
                id: Date.now().toString(),
                userId: currentUser?.displayName || "åŒ¿å",
                text: replyText,
                date: Date.now(),
                likes: 0,
                replies: [],
              };
              const parentComment = findCommentById(id, comments);
              if (parentComment) {
                parentComment.replies = parentComment.replies || [];
                parentComment.replies.push(reply);
                saveComments();
                renderComments();
              }
            });
            cancelBtn.addEventListener("click", () => {
              replyBox.remove();
            });
          }
        }
      });

      function findCommentById(id, list) {
        for (const comment of list) {
          if (comment.id === id) return comment;
          if (comment.replies && comment.replies.length > 0) {
            const found = findCommentById(id, comment.replies);
            if (found) return found;
          }
        }
        return null;
      }

      function deleteCommentById(id, list) {
        for (let i = 0; i < list.length; i++) {
          if (list[i].id === id) {
            list.splice(i, 1);
            return true;
          }
          if (list[i].replies && list[i].replies.length > 0) {
            const deleted = deleteCommentById(id, list[i].replies);
            if (deleted) return true;
          }
        }
        return false;
      }

      ToggleComment.addEventListener("click", ToggleShowAndHideComment);

      function ToggleShowAndHideComment() {
        if (document.getElementById("comment-section").style.display === "none") {
          document.getElementById("comment-section").style.display = "block";
          document.querySelector(".ToggleComment").textContent = "ã‚³ãƒ¡ãƒ³ãƒˆã‚’éè¡¨ç¤º";
        } else {
          document.getElementById("comment-section").style.display = "none";
          document.querySelector(".ToggleComment").textContent = "ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¡¨ç¤º";
        }
      }
      renderComments();
    </script>
  </body>
</html>



